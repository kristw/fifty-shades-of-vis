!function(a,b){"function"==typeof define&&define.amd?define(["angular","vega"],b):"object"==typeof exports?module.exports=b(require("angular"),require("vega")):b(a.angular,a.vg)}(this,function(a,b){function c(a,b){var c;return function(){var d=this,e=arguments,f=function(){c=null,a.apply(d,e)};return clearTimeout(c),c=setTimeout(f,b),d}}return a.module("ngVega",[]).directive("vega",function(){return{restrict:"AE",scope:{spec:"=",data:"=vegaData",renderer:"=vegaRenderer"},link:function(d,e,f){function g(){b.parse.spec(d.spec,function(a){h=a({el:j,data:i,renderer:d.renderer||"svg"}).update()})}var h,i,j=e[0],k=c(g,50);d.$watch("spec",k,!0),d.$watch("data",function(b){i={},a.isDefined(b)&&Object.keys(b).forEach(function(c){var d=b[c];i[c]=a.isFunction(d)?d:function(a){a.remove(function(a){return!0}).insert(d)}}),h?h.data(i).update():k()},!0),d.$watch("renderer",function(a){h?h.renderer(a).update():k()})}}})});